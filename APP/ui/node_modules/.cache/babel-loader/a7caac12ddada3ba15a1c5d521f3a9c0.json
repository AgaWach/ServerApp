{"ast":null,"code":"import _regeneratorRuntime from \"/Users/helena/Desktop/ServerApp/APP/ui/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/helena/Desktop/ServerApp/APP/ui/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/helena/Desktop/ServerApp/APP/ui/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/helena/Desktop/ServerApp/APP/ui/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/helena/Desktop/ServerApp/APP/ui/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/helena/Desktop/ServerApp/APP/ui/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"/Users/helena/Desktop/ServerApp/APP/ui/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"/Users/helena/Desktop/ServerApp/APP/ui/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/helena/Desktop/ServerApp/APP/ui/src/components/ServersTable.js\";\nimport React, { Component } from 'react';\nimport axios from \"axios\";\nimport Paper from \"@material-ui/core/Paper\";\nimport Button from \"@material-ui/core/Button\";\nimport TableCell from \"@material-ui/core/TableCell\";\nimport TableRow from \"@material-ui/core/TableRow\";\nimport TableBody from \"@material-ui/core/TableBody\";\nimport TableHead from \"@material-ui/core/TableHead\";\nimport Table from \"@material-ui/core/Table\";\nimport Chart from './Chart';\n\nvar ServersTable =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(ServersTable, _Component);\n\n  function ServersTable(props) {\n    var _this;\n\n    _classCallCheck(this, ServersTable);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(ServersTable).call(this, props));\n    _this.state = {\n      chosenServerId: '',\n      servers: [],\n      showMenu: false\n    };\n    _this.showMenu = _this.showMenu.bind(_assertThisInitialized(_this));\n    _this.closeMenu = _this.closeMenu.bind(_assertThisInitialized(_this));\n    return _this;\n  }\n\n  _createClass(ServersTable, [{\n    key: \"showMenu\",\n    value: function showMenu(event) {\n      var _this2 = this;\n\n      event.preventDefault();\n      this.setState({\n        showMenu: true\n      }, function () {\n        document.addEventListener('click', _this2.closeMenu);\n      });\n    }\n  }, {\n    key: \"closeMenu\",\n    value: function closeMenu() {\n      var _this3 = this;\n\n      this.setState({\n        showMenu: false\n      }, function () {\n        document.removeEventListener('click', _this3.closeMenu);\n      });\n    }\n  }, {\n    key: \"turn\",\n    value: function () {\n      var _turn = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(serverId, action) {\n        var result, serverIndex, server;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                this.setState({\n                  servers: this.props.servers\n                });\n                _context.next = 3;\n                return axios.put(\"http://localhost:4454/servers/\".concat(serverId, \"/\").concat(action));\n\n              case 3:\n                result = _context.sent;\n                console.log({\n                  result: result\n                });\n\n                if (result.status === 200) {\n                  serverIndex = this.props.servers.findIndex(function (x) {\n                    return x.id === result.data.id;\n                  });\n\n                  if (serverIndex > -1) {\n                    if (result.data.status === 'REBOOTING') {\n                      server = {};\n                      server = this.rebooting(serverId, server);\n                      console.log({\n                        server: server\n                      });\n                    }\n\n                    this.props.servers[serverIndex].status = result.data.status;\n                    this.setState({\n                      servers: this.props.servers\n                    });\n                  }\n                } else if (result.status === 400) {\n                  console.log(\"Error\");\n                }\n\n              case 6:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function turn(_x, _x2) {\n        return _turn.apply(this, arguments);\n      }\n\n      return turn;\n    }()\n  }, {\n    key: \"rebooting\",\n    value: function () {\n      var _rebooting = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee4(serverId, server) {\n        var _this4 = this;\n\n        return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                if (!server) {\n                  setInterval(\n                  /*#__PURE__*/\n                  _asyncToGenerator(\n                  /*#__PURE__*/\n                  _regeneratorRuntime.mark(function _callee2() {\n                    return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n                      while (1) {\n                        switch (_context2.prev = _context2.next) {\n                          case 0:\n                            _context2.next = 2;\n                            return axios.get(\"http://localhost:4454/servers/\".concat(serverId, \"/\"));\n\n                          case 2:\n                            server = _context2.sent;\n                            console.log(server);\n\n                            if (!(server.data.status === 'REBOOTING')) {\n                              _context2.next = 9;\n                              break;\n                            }\n\n                            _context2.next = 7;\n                            return _this4.rebooting(serverId, server);\n\n                          case 7:\n                            _context2.next = 11;\n                            break;\n\n                          case 9:\n                            if (!(server.data.status === 'ONLINE')) {\n                              _context2.next = 11;\n                              break;\n                            }\n\n                            return _context2.abrupt(\"return\", server);\n\n                          case 11:\n                          case \"end\":\n                            return _context2.stop();\n                        }\n                      }\n                    }, _callee2);\n                  })), 1000);\n                }\n\n                setInterval(\n                /*#__PURE__*/\n                _asyncToGenerator(\n                /*#__PURE__*/\n                _regeneratorRuntime.mark(function _callee3() {\n                  return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n                    while (1) {\n                      switch (_context3.prev = _context3.next) {\n                        case 0:\n                          _context3.next = 2;\n                          return axios.get(\"http://localhost:4454/servers/\".concat(serverId, \"/\"));\n\n                        case 2:\n                          server = _context3.sent;\n                          console.log(server);\n\n                          if (!(server.data.status === 'REBOOTING')) {\n                            _context3.next = 9;\n                            break;\n                          }\n\n                          _context3.next = 7;\n                          return _this4.rebooting(serverId, server);\n\n                        case 7:\n                          _context3.next = 10;\n                          break;\n\n                        case 9:\n                          return _context3.abrupt(\"return\", server);\n\n                        case 10:\n                        case \"end\":\n                          return _context3.stop();\n                      }\n                    }\n                  }, _callee3);\n                })), 1000);\n\n              case 2:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4);\n      }));\n\n      function rebooting(_x3, _x4) {\n        return _rebooting.apply(this, arguments);\n      }\n\n      return rebooting;\n    }()\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this5 = this;\n\n      return React.createElement(Paper, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 86\n        },\n        __self: this\n      }, React.createElement(Table, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 87\n        },\n        __self: this\n      }, React.createElement(TableHead, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 88\n        },\n        __self: this\n      }, React.createElement(TableRow, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 89\n        },\n        __self: this\n      }, React.createElement(TableCell, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 90\n        },\n        __self: this\n      }, \"NAME\"), React.createElement(TableCell, {\n        align: \"left\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 91\n        },\n        __self: this\n      }, \"STATUS\"), React.createElement(TableCell, {\n        align: \"right\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 92\n        },\n        __self: this\n      }))), React.createElement(TableBody, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 95\n        },\n        __self: this\n      }, this.props.servers.map(function (server) {\n        return React.createElement(TableRow, {\n          key: server.name,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 97\n          },\n          __self: this\n        }, React.createElement(TableCell, {\n          component: \"th\",\n          scope: \"row\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 98\n          },\n          __self: this\n        }, server.name), React.createElement(TableCell, {\n          align: \"left\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 101\n          },\n          __self: this\n        }, server.status), React.createElement(TableCell, {\n          align: \"right\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 102\n          },\n          __self: this\n        }, server.status === 'ONLINE' ? React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 105\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 106\n          },\n          __self: this\n        }, React.createElement(Paper, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 107\n          },\n          __self: this\n        }, React.createElement(Button, {\n          onClick: function onClick() {\n            return _this5.turn(server.id, 'off');\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 108\n          },\n          __self: this\n        }, \"Turn Off \"), React.createElement(Button, {\n          onClick: function onClick() {\n            return _this5.turn(server.id, 'reboot');\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 110\n          },\n          __self: this\n        }, \"Reboot\"), React.createElement(Button, {\n          onClick: _this5.showMenu,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 111\n          },\n          __self: this\n        }, \"STATISTIC\"), _this5.state.showMenu ? React.createElement(Chart, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 113\n          },\n          __self: this\n        }) : null))) : React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 121\n          },\n          __self: this\n        }, React.createElement(Paper, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 122\n          },\n          __self: this\n        }, React.createElement(Button, {\n          onClick: function onClick() {\n            return _this5.turn(server.id, 'on');\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 123\n          },\n          __self: this\n        }, \"Turn on\"), React.createElement(Button, {\n          onClick: function onClick() {\n            return _this5.turn(server.id, 'reboot');\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 126\n          },\n          __self: this\n        }, \"Reboot\")))));\n      }))));\n    }\n  }]);\n\n  return ServersTable;\n}(Component);\n\nexport default ServersTable;","map":{"version":3,"sources":["/Users/helena/Desktop/ServerApp/APP/ui/src/components/ServersTable.js"],"names":["React","Component","axios","Paper","Button","TableCell","TableRow","TableBody","TableHead","Table","Chart","ServersTable","props","state","chosenServerId","servers","showMenu","bind","closeMenu","event","preventDefault","setState","document","addEventListener","removeEventListener","serverId","action","put","result","console","log","status","serverIndex","findIndex","x","id","data","server","rebooting","setInterval","get","map","name","turn"],"mappings":"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","sourcesContent":["import React, {Component} from 'react';\nimport axios from \"axios\";\nimport Paper from \"@material-ui/core/Paper\";\nimport Button from \"@material-ui/core/Button\";\nimport TableCell from \"@material-ui/core/TableCell\";\nimport TableRow from \"@material-ui/core/TableRow\";\nimport TableBody from \"@material-ui/core/TableBody\";\nimport TableHead from \"@material-ui/core/TableHead\";\nimport Table from \"@material-ui/core/Table\";\nimport Chart from './Chart';\n\nclass ServersTable extends Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            chosenServerId: '',\n            servers: [],\n            showMenu: false,\n        };\n        this.showMenu = this.showMenu.bind(this);\n        this.closeMenu = this.closeMenu.bind(this);\n    };\n\n    showMenu(event) {\n        event.preventDefault(); \n        this.setState({ showMenu: true }, () => {\n            document.addEventListener('click', this.closeMenu);\n          });\n    }\n\n    closeMenu() {\n        this.setState({ showMenu: false }, () => {\n          document.removeEventListener('click', this.closeMenu);\n        });\n      }\n\n    async turn(serverId, action) {\n        this.setState({\n            servers: this.props.servers,\n        });\n        const result = await axios.put(`http://localhost:4454/servers/${serverId}/${action}`);\n        console.log({result});\n        if (result.status === 200) {\n            const serverIndex = this.props.servers.findIndex(x => x.id === result.data.id);\n            if (serverIndex > -1) {\n                if (result.data.status === 'REBOOTING') {\n                    let server = {};\n                    server = this.rebooting(serverId, server);\n                    console.log({server});\n                }\n                this.props.servers[serverIndex].status = result.data.status;\n                this.setState({\n                    servers: this.props.servers,\n                });\n            }\n        } else if (result.status === 400) {\n            console.log(\"Error\")\n        }\n    }\n\n    async rebooting(serverId, server) {\n        if (!server) {\n            setInterval(async () => {\n                server = await axios.get(`http://localhost:4454/servers/${serverId}/`);\n                console.log(server);\n                if (server.data.status === 'REBOOTING') {\n                    await this.rebooting(serverId, server)\n                } else if (server.data.status === 'ONLINE') {\n                    return server;\n                }\n            }, 1000);\n        }\n        setInterval(async () => {\n            server = await axios.get(`http://localhost:4454/servers/${serverId}/`);\n            console.log(server);\n            if (server.data.status === 'REBOOTING') {\n                await this.rebooting(serverId, server)\n            } else {\n                return server;\n            }\n        }, 1000);\n    }\n\n    render() {\n        return (\n            <Paper>\n                <Table>\n                    <TableHead>\n                        <TableRow>\n                            <TableCell>NAME</TableCell>\n                            <TableCell align=\"left\">STATUS</TableCell>\n                            <TableCell align=\"right\"></TableCell>\n                        </TableRow>\n                    </TableHead>\n                    <TableBody>\n                        {this.props.servers.map(server => (\n                            <TableRow key={server.name}>\n                                <TableCell component=\"th\" scope=\"row\">\n                                    {server.name}\n                                </TableCell>\n                                <TableCell align=\"left\">{server.status}</TableCell>\n                                <TableCell align=\"right\">\n                                        {\n                                            server.status === 'ONLINE' ? (\n                                                <div>\n                                                    <div>\n                                                        <Paper>\n                                                        <Button onClick={() => this.turn(server.id, 'off')}>\n                                                          Turn Off </Button>\n                                                        <Button onClick={() => this.turn(server.id, 'reboot')}>Reboot</Button>\n                                                        <Button onClick={this.showMenu}>STATISTIC</Button>\n                                                        {this.state.showMenu ? (\n                                                          <Chart />  \n                                                        ): (\n                                                            null\n                                                        )}\n                                                        </Paper>\n                                                    </div>\n                                                </div>\n                                            ) : (\n                                                <div>\n                                                    <Paper>\n                                                    <Button onClick={() => this.turn(server.id, 'on')}>\n                                                      Turn on\n                                                    </Button>\n                                                    <Button onClick={() => this.turn(server.id, 'reboot')}>\n                                                      Reboot\n                                                    </Button>\n                                                    </Paper>\n                                                </div>\n                                            )\n                                        }\n                                </TableCell>\n                            </TableRow>\n                        ))}\n                    </TableBody>\n                </Table>\n            </Paper>\n        );\n    }\n}\n\nexport default ServersTable;\n"]},"metadata":{},"sourceType":"module"}